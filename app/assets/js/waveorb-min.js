!function(){var e=async function(e,n){var t=1,o=1e3,r=1001,c="$cbid";n||(n={}),void 0!==n.reconnect&&!0!==n.reconnect||(n.reconnect=1e3),!0===n.ping&&(n.ping=1e3),void 0===n.disconnect&&(n.disconnect=3e3);for(var i,a,s,u,f,l={},p=["message","open","close","error"],d=0;d<p.length;d++)l[p[d]]=[];function v(e,...n){for(var t=0;t<l[e].length;t++)l[e][t](...n)}function m(t,o){a={},s=0,(i=new WebSocket(e)).onmessage=function(e){var n=JSON.parse(e.data),t=n[c];t?(delete n[c],a[t]&&(a[t](n,e),delete a[t])):v("message",n,e)},i.onopen=function(e){t&&t(h),v("open",h,e),n.ping&&(clearInterval(u),clearTimeout(f),u=setInterval(function(){w({$ping:1})},n.ping),f=setTimeout(function(){clearInterval(u),g(r)},n.disconnect))},i.onerror=function(e){o&&o(e),v("error",e)},i.onclose=function(e){n.reconnect&&setTimeout(m,n.reconnect),v("close",e)}}function g(e){e=e||o,i.close(e)}function w(e){i.readyState===t&&i.send(JSON.stringify(e))}var h={on:function(e,n){l[e].push(n)},connect:m,send:w,fetch:function(e){return new Promise(function(n){e[c]=++s,a[s]=function(e){n(e)},w(e)})},disconnect:g};return new Promise(m)},n=function(e,n,t){return new Promise(function(o,r){t||(t={}),n||(n={});var c,i=new XMLHttpRequest;if(i.addEventListener("load",function(e){var n=JSON.parse(i.responseText);o(n)}),i.addEventListener("error",function(e){r(i)}),i.open(t.method||"POST",e+(t.path||"/")),t.files){for(var a in c=new FormData,n)c.append(a,n[a]);for(var s of t.files)c.append("file",s,s.name);t.progress&&i.upload.addEventListener("progress",function(e){e.percent=(e.loaded/e.total*100).toFixed(2),t.progress(e)})}else i.setRequestHeader("Content-Type","application/json; charset=utf-8");i.withCredentials=!0,i.send(c||JSON.stringify(n))})};window.waveorb=function(t,o){if(0===t.indexOf("ws"))return e(t,o||{});{function r(e,o){return n(t,e,o)}return{fetch:r,upload:function(e,n){return n||(n={}),new Promise(function(t){var o=document.createElement("input");o.type="file",o.value=null,n.multiple&&(o.multiple=!0),n.accept&&(o.accept=n.accept),o.onchange=function(){r(e,{files:o.files}).then(function(e){t(e)})},o.click()})}}}}}();